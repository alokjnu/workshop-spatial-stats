<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Random fields | Introduction to spatial statistics in R</title>
  <meta name="description" content="2 Random fields | Introduction to spatial statistics in R" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Random fields | Introduction to spatial statistics in R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://ucdavisdatalab.github.io/workshop-spatial-stats/" />
  
  
  <meta name="github-repo" content="ucdavisdatalab/YOUR_REPO" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Random fields | Introduction to spatial statistics in R" />
  
  
  

<meta name="author" content="Wesley Brooks" />


<meta name="date" content="2021-05-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="spatial-data.html"/>
<link rel="next" href="geostatistics.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://datalab.ucdavis.edu/">
  <img src="https://datalab.ucdavis.edu/wp-content/uploads/2019/07/datalab-logo-full-color-rgb-1.png" style="height: 100%; width: 100%; object-fit: contain" />
</a></li>
<li><a href="./" style="font-size: 18px">Introduction to spatial statistics in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="1" data-path="spatial-data.html"><a href="spatial-data.html"><i class="fa fa-check"></i><b>1</b> Spatial data</a></li>
<li class="chapter" data-level="2" data-path="random-fields.html"><a href="random-fields.html"><i class="fa fa-check"></i><b>2</b> Random fields</a></li>
<li class="chapter" data-level="3" data-path="geostatistics.html"><a href="geostatistics.html"><i class="fa fa-check"></i><b>3</b> Geostatistics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="geostatistics.html"><a href="geostatistics.html#example-rongelap-radiation"><i class="fa fa-check"></i><b>3.1</b> Example: Rongelap radiation</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="geostatistics.html"><a href="geostatistics.html#kriging"><i class="fa fa-check"></i><b>3.1.1</b> Kriging</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="geostatistics.html"><a href="geostatistics.html#example-meuse-river-zinc-pollution"><i class="fa fa-check"></i><b>3.2</b> Example: Meuse River zinc pollution</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="geostatistics.html"><a href="geostatistics.html#kriging-the-meuse-data"><i class="fa fa-check"></i><b>3.2.1</b> Kriging the Meuse data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="areal-data.html"><a href="areal-data.html"><i class="fa fa-check"></i><b>4</b> Areal data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="areal-data.html"><a href="areal-data.html#example-north-carolina-sids"><i class="fa fa-check"></i><b>4.1</b> Example: North Carolina SIDS</a></li>
<li class="chapter" data-level="4.2" data-path="areal-data.html"><a href="areal-data.html#neighbor-weighting"><i class="fa fa-check"></i><b>4.2</b> Neighbor weighting</a></li>
<li class="chapter" data-level="4.3" data-path="areal-data.html"><a href="areal-data.html#morans-i"><i class="fa fa-check"></i><b>4.3</b> Moran’s I</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="point-processes.html"><a href="point-processes.html"><i class="fa fa-check"></i><b>5</b> Point processes</a>
<ul>
<li class="chapter" data-level="5.1" data-path="point-processes.html"><a href="point-processes.html#import-and-plot-valley-oak-locations"><i class="fa fa-check"></i><b>5.1</b> Import and plot valley oak locations</a></li>
<li class="chapter" data-level="5.2" data-path="point-processes.html"><a href="point-processes.html#poisson-point-process"><i class="fa fa-check"></i><b>5.2</b> Poisson point process</a></li>
<li class="chapter" data-level="5.3" data-path="point-processes.html"><a href="point-processes.html#ripleys-k"><i class="fa fa-check"></i><b>5.3</b> Ripley’s K</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to spatial statistics in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="random-fields" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Random fields</h1>
<blockquote>
<p>“[The Force] surrounds and penetrates us. It binds the galaxy together.” - Obi-Wan Kenobi</p>
</blockquote>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="random-fields.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>( <span class="st">&quot;RandomFields&quot;</span> )</span></code></pre></div>
<p>A random field is like The Force - it is everywhere without being seen. Air particulate concentration, ground water level, soil lead concentration - you may be aware that these phenomena are everywhere. Sociological phenomena like public sentiment or land value may also be thought of as an ether or field that flows everywhere.</p>
<p>But our data doesn’t surround and penetrate us; it doesn’t flow through everything. Data, the observations that we actually have to work from, are quite sparse measurements of the underlying field. So our task in spatial data analysis (what makes it different from other kinds of data analysis) is generally to estimate parameters of a random field.</p>
<p>Here I’ve prepared a couple of graphics to try to connect spatial statistics to an intuition about spatial data. The reason that we always use the normal distribution for a spatial field is because it is the foremost among VERY few distributions that have a multivariate form.</p>
<div class="figure">
<img src="img/sample-points.png" alt="" />
<p class="caption">rongelap-illustration</p>
</div>
<div class="figure">
<img src="img/field-properties.png" alt="" />
<p class="caption">rongelap-illustration</p>
</div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="random-fields.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set range parameter</span></span>
<span id="cb2-2"><a href="random-fields.html#cb2-2" aria-hidden="true" tabindex="-1"></a>range <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb2-3"><a href="random-fields.html#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="random-fields.html#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># make a plot of the exponential correlation</span></span>
<span id="cb2-5"><a href="random-fields.html#cb2-5" aria-hidden="true" tabindex="-1"></a>tt <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length.out=</span><span class="dv">300</span>)</span>
<span id="cb2-6"><a href="random-fields.html#cb2-6" aria-hidden="true" tabindex="-1"></a>cov_fun <span class="ot">=</span> <span class="fu">exp</span>( <span class="sc">-</span>tt <span class="sc">/</span> range)</span>
<span id="cb2-7"><a href="random-fields.html#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( tt, cov_fun, <span class="at">type=</span><span class="st">&#39;l&#39;</span>, <span class="at">bty=</span><span class="st">&#39;n&#39;</span>, <span class="at">xlab=</span><span class="st">&quot;distance&quot;</span>, <span class="at">ylab=</span><span class="st">&#39;correlation&#39;</span>)</span></code></pre></div>
<p><img src="02_random-fields_files/figure-html/exponential-covariance-1.png" width="672" /></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="random-fields.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same plot, but as a variogram</span></span>
<span id="cb3-2"><a href="random-fields.html#cb3-2" aria-hidden="true" tabindex="-1"></a>nugget <span class="ot">=</span> <span class="fl">0.2</span></span>
<span id="cb3-3"><a href="random-fields.html#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( tt, <span class="dv">1</span> <span class="sc">-</span> cov_fun <span class="sc">+</span> nugget, <span class="at">type=</span><span class="st">&#39;l&#39;</span>, <span class="at">bty=</span><span class="st">&#39;n&#39;</span>,</span>
<span id="cb3-4"><a href="random-fields.html#cb3-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.3</span>), <span class="at">xlab=</span><span class="st">&quot;distance&quot;</span>, <span class="at">ylab=</span><span class="st">&#39;semivariance&#39;</span>)</span></code></pre></div>
<p><img src="02_random-fields_files/figure-html/exponential-covariance-2.png" width="672" /></p>
<p>To illustrate observations from a random field, let’s do a bit of simulation. I’ll use the <code>RandomFields</code> package, so you’ll need to install that. The <code>RMexp()</code> function uses the exponential covariance function. I’m creating four independent realizations of data so that you can see what the variability looks like.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="random-fields.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate six realizations with an exponential model</span></span>
<span id="cb4-2"><a href="random-fields.html#cb4-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">RMexp</span>()</span>
<span id="cb4-3"><a href="random-fields.html#cb4-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.1</span>)</span>
<span id="cb4-4"><a href="random-fields.html#cb4-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">RFsimulate</span>(model, x, x, <span class="at">n=</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## ....</code></pre>
<pre><code>## New output format of RFsimulate: S4 object of class &#39;RFsp&#39;;
## for a bare, but faster array format use &#39;RFoptions(spConform=FALSE)&#39;.</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="random-fields.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the simulations</span></span>
<span id="cb7-2"><a href="random-fields.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( z )</span></code></pre></div>
<p>Out of curiosity, let’s see how those would look if we used another covariance function. Here I’m using cubic covariance, which is important only insofar as you can see that any effect on the data isn’t obvious.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="random-fields.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The effect of the covariance model is typically not obvious:</span></span>
<span id="cb8-2"><a href="random-fields.html#cb8-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">RMcubic</span>()</span>
<span id="cb8-3"><a href="random-fields.html#cb8-3" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">RFsimulate</span>(model, x, x, <span class="at">n=</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## ....</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="random-fields.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( z )</span></code></pre></div>
<p>The fact that the proper covariance function is seldom obvious means that the ultimate choice often seems fairly arbitrary. This contributes to why spatial statistics is so balkanized, with dozens of very closely related methods that use incompatible language and software.</p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="spatial-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="geostatistics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ucdavisdatalab/workshop-spatial-stats/edit/master/02_random-fields.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/ucdavisdatalab/workshop-spatial-stats/blob/master/02_random-fields.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
